To have a look at : http://www.spacejock.com/SEDataFAQ.html

Deliv :
	-send email, update comments
	
Ideas : 
 - Give ability to set up strategies.
 - Get data from SOA : interactive broker .com? other (cf interviews book for protocol - uddi registry ??). => only US at the moment!
 - Web interface (google webkit) + applet.
 - Offer a web ui : 
 	- pickup a share from a market.
 	- run 6 month onTFTuning.
 	- display result.
 	- offer to send email on next signal.

Soft :
 Errors :
 - Get rid of Reuters ????
 - Negative Past Rates for Barc and eurasian? => check the 40-60 range. Is payout accurate vs yield?
 - use yahoo uk estimates for euro shares instead of us
 	=> save the EPS in formater and calculate PEG with last quote when calculation is on. => Test
 
 - Profit is wrong on Screening portfolios. => Test
 - Check name on analyst estimate from US!! => Test
 - Check boursorma bna rate calculation for RIO TINTO ORD 10P/RIO.L/GB0007188757?! => Test
 - Consider nb estimate for Reuters? => Test
 - Huge payouts ratios (over 100 can't be true right? ) from Reuters invalidate the analysis.... => Test
 
 - Portfolio :
 	- Market is not a currency : these should be taken apart ?...
 	- Value is wrong when purchasing new share
 - Tuning :
	- Out is sometimes null	: relation to the no quotation problem?		
 - AutoPortfolio :
 	- add a reinforce buy and partial sell system
	- compare csv perf with real
 	- do events have to be calculated before start date?
	- forced sell yoyo effect : related to alert asynch calculation  => invalidate alerts??
 	- sell alerts must apply after buy date only cf. 12bestCac_macdSmaRsiMaxl2%
 	- sell check of 0 won't work if buying at the peak.
	- the total number of lines needs to be fixed : how do I sell to buy a new one? => I set a limit but is  that enough?
	
 - ASX : wrong currency + pb with names containing ","
 - Check alert on stop loss
 - change in the portfolio should change the last date updated for monitored
 - when insert a share with no quotes => trigger up date then refresh?
 - Unit tests for Portfolio management and events window ...

Improve :
 - scrape last quotations on yahoo and investir web pages
 - Integrate alerts and screening events as bearish / bullish event and get rid of other eventType (idem as weather events)
		 //TODO Threshold cross could be integrated in the bullish/bearish system : Buy cross is bullish and Sell cross is bearish ...
		////	//TODO Partial sell in case of signals contradiction. ie ForceSell at t0 and SreennerBuy at t0+n or ForceSell and ScreenerBuy at t0
		////	//Force Sell at t0+n and ScrennerBuy at t0 should sell and it does at the moment. The two other cases above will keep at the moment.
		////	//The ForceSell and ScreenerBuy at t0 is just working because the ScrennerBuy event is sorted > to the Force Sell event and hence the Force Sell will be ignored if happening at the same time.
		////	//case one : cross happens as the stock is still in screening top 10 => keep
		////	//case two : cross happens as the stock as left the screening top 10 => sell
		////	//case three : cross happens as the stock is in the screening bottom N => sell
		////	//NB : THIS MAY BE CADUC AS WE HAVE NOW TWO DIFFERENT SIGNALS FOR BUY AND SELL 
		- problem is what about the BEARISH and BULLISH events now should we filter Bullish and Bearish in respectively buy and sell signals?
		- the second problem is that we want to check all alerts signals and only the latest for indicators and screening ?
 - UI :
 - use "ecartype" or something similar instead of threshold to exclude wrong trend full rating values
 - Genetic Algo
 - Screening :	
    - reuters : http://www.reuters.com/finance/stocks/financialHighlights?symbol=PAJ.PA
    - refactor trend providers (patterns??) : shouldn't all be in Yahoo!!
	- conseils : www.easybourse.com, Zone Bourse, Le Journal de la Bourse et Cercle finance, boursier.com
 	- Dividendes from bourso
 - AutoPortfolio :
 	- Add partial sells
 	- Alert sell dependent on avg buy price position
 	- TODO implement a Tuning Autoportfolio based on opinion history (cf Screener main). Things to be care full of : EndDate hard coded as new date. signalName hard coded
 	- Add a modal to create AutoPortfolio :
 		- tick technical analysis on and off
 		- upload initial from gnucashfile option
 	- Autoportfolio sell : on Thresholds and/or Technical Analysis events. 
 	- Autoportfolio buy :  Screening.
 		
 	- Sell Alerts can't work as you'll buy and sell and buy (on the same event) like a yoyo !!!
 	- Alert depends on portfolio historic and hence must be calculated in sequence between portfolio changes (cf idea of stack below)
 	- Signal calculation on a time period has to happen after all stocks events have been calculated on the same time period 
 		(hence the ProcessorMessage sent at the end of the event calculation) 
 		=> implement a stack to stack set of events and processor message ie add a sequence order in the message queue.
 		=> or send all events at once....
	- Filter calculation on stock and share type
 	- Take Alerts apart from event as they depends on the portfolio status and hence are different ...
 		This apply for calculation (event, signal) as well as for storage.
 - Shares file loading : merge/update instead of add all. in shares table as well as in portfolio
 - Add More sophisticated button/setting logic
   => bubble on mouse over the buttons showing options/help
   => Add OR|XOR binary logic like for the resulting options if needed
 - an option to set the first stop loss threshold?
 - available data : real amount paid and quotation or quotation and number of shares (add 1% fees?)

Business :
 --	Baraca : CAC August - Sept 2008 bought to late and couldn't make it to the 4% 
	=> can I buy earlier??
	=> do I have to reduce the margin?
	Market baraca : follow the indexes!!
 -- Portfolio : 
 - Curves visible on the chart should be selectable (check box?)
 - Add :  Stock type + up to date indicator
 - Show list of markets vs categories to choose from for help when uploading file
 - Refresh of portfolio when quotations are updated?
 - When inserting a new position, 
	- calculate stop loss alert - and recalculate every time + loss threshold, gain prospect.
	  => a loss must be 
		< 2% of the total capital, < 6%-8% of the capital in that same share, 
		> to the av (?) min intraday fluctuation ie volatility or average true range 
	- calculate alerts base on % amounts gain and loss?
 - Alerts : Set up a more fine grain alert type that give ability to clean automaticaly set alerts with the manually ones.
 - Include fees, improve nb shares/price modification, Portfolio cash in should be modifiable.
 -- Events :
 - Force events recalculation when date as bean changed in UI ie "apply" 
	+ needs some checks and a force mod??
	+ how is it calculated for now
 - Same event should not be triggered several times.
 - Add a ticker capacity to choose to on display of an event 
	+ filter or highligt by portfolio?
	+ colors or signals to signal type of monitor level on events
	+ colors or order to show the new or old events!!
	- Add Event marker to hide already seen events 
	- would add per event for specific dates and not per share as it is now.
	=> add acces to a dynamic list with each item having a color and a label 
		and feature to set them to events + sort option.
 -- Indicators :
 - 200 day average gap => tendencies/trend indications ??
 - MA 50
 - trend following : 50 day EMA crossing from dummy p 251
 - break out gap
 - 5, 10 day Donchian Channel from dummy p 257
 - BPI - bullish percent index from the dummy
 - BPI = Calculate the buy and sell ratio + Event average all over the market.
 - Add other criteria for bullish and bearish = cf. trading for dummies.
   => sectors / categories ...
   => Volumes
 -- Others :
 - email, subject as to be = latest alarm ??	

Perf:
 - deleting 200 shares and related quotation takes something like 10 minutes ...
 => Derby optimisation 
 - SLOW MACD??
 => AOP to detect problem
 - install with light sample market and add a screen for market choice/db download at install 
 - progress bar update not accurate ... => find a way
 
Archi :
 - Trend delegate service in provider instead of model object TrendSupplemented. 
 - Refactor market addition so it's by config : cf addingMarket.txt
 - factorise the send event methods which are scattered around.
 - The Monitor level should move from Portfolio to the stock Or an other related object that would also include alert infos.
 - Run in back ground : at OS start in service or daemon mode (retrieve monitored shares quotations + others?)
 	- The update should run has a daemon/service and the UI should connect to that service - JMS? or prop API?.
 - implement the pattern observer to update the event list from the list attribute(from the DB?) 
 	=> refactor for a proper MVC model
 - part the common from the specific in provider or http source (http source only??)
 - part list retrieve from quote retrieve in Providers => create new generic types of Providers according to that.
 - read spring bean doc and fix the ctx access pb - APPLICATION_CONTEXT mgnt?.
 - fix tests and run test suite.

INFO :
  - About start calculation from latest events.
     --- talib : date -1 to today is ok.
     --- mas :  - server setting have impact on nb alerts : must be > date client
      - lost of certain data on server or client date setting. => dependent on the analyser (derivations of derivations)
      - only retrieve events in the range specified by client 
  - Screnner and Autoportfolio :
  	- The trend is loaded in DB from the web on regular basis for defined share lists (markets) by the Sceenner
  	- The screener get the trends data and create a list of SymbolEvents in the form of Alerts for defined share lists (markets) via the Exporters
  	- The screener then send a SignalProcessorAnalysis event that will trigger the calcultation in the Autoportfolio
  	- The autoportfolio loads the SymbolEvents from the data base and buy/sell according to the weigh of these events (using the Ponderation Rule).
  - Indicators, calculation service and Autoportfolio :
  	- The Indicator service is retrieved from the Spring context by the caller.
  	- a call to partialAnalyze or equivalent will trigger the analyze and the generation of SymbolEvents in DB
  	- The same way as for the Trend Events operated by the Screener, these events are picked Up in the DB by the Autoportfolio and filtered by the Ponderation Rule.
  - Thresholds crossing and Autoportfolio :
  	- Alerts on thresholds have to be generated in a different manner as they apply to portfolio content (buy and sell prices) 
  	and not to stock history data or external information as per the previous discussed (Screnning and Indicators).
  	- Hence what will be analysed here is not a list of stocks or market but the content of the portfolio them selves.
  	- Alerts on threshold are set on portfolios. The alert analyser goes through the portfolios and their Alerts and generate symbolEvents (same way as the two others).
  	- The Autoportfolio will yet again load these SymbolEvents form the DB and do the buy/sell accordingly.
  - Threshold crossing and Alert reseting :
  	- The Alerts are reset by the AlertParser its self when a crossing is detected as well as generating a SymbolEvent.
  	- The symbolEvents generated by Threshold crossing will be read by the AutoPortfolio for sell and buy (FORCESELL) process.
  - Crossing and Trend info
  	- SymbolEvents like THRESHOLD crossing and SREENERINFO will be processed by the AnaliseClient to send information email only and are not used by the AutoPortfoios.

Neural observation :
	??A high es (Span of indicator Events collected to calcutate the neural events. ex. 50) with a low expectation smothing sma (ex. 5) tends to give :
	similar results as a lower es (ex. 5) with a high (ex. 50, 100) sma smothing sma??

Notes :
- Currency :
	- Stock.getMarket().getCurrency() is the currenty the quotations are stored in.
	- PortfolioShare.getTransactionCurrency() is the currency the stock has been bought and will be sold.
	- Portfolio.getPorfolioCurrency() is the currency of the portfolio in case it hosts only one Currency (eg. UserPoertfolio and TuningPortfolio).
	  All stock bougth and sold in such portfolio must be in the Currency of the portfolio.
	  When it is null, the portfolio potentialy hosts several currency and the Stock / PortfolioShare currency is used for buying and sell. In that case, the total amounts are converted in EUR.
	- IndicatorCalculation.getCalculationCurrency() is the currency the events are calculated in. Be careful to keep this and the PortfolioShare currencies consistent when calculating.
	
	Tunning can be done eather by selecting a currency or using the stock currency.
	- While using the stock currency (ie portfolioCurrency == null): all calculation are made using that currency. Buy and sell will be made with a convertion in EUR.
	- While using a specified currency : all calculation are using the latest. Buy and sell will be made with a convertion in EUR as well.
	If the stock is in EUR, by default no convertion is done. 
	If the stock is in USD, by default the calculation are in USD, buy and sell are in USD but total amounts are converted into EUR.
	If the stock is in USD and EUR as been specified, all quotations will be converted in EUR before calculation and buy and sell will be in EUR as well.
	If the stock is in USD and GBP as been specified, all quotations will be converted in GBP before calculation and buy and sell will be in GBP. But total amount are converted in EUR.
	If the stock is in USD and nothing is sepcified, all calculation are in USD, buy and sell will be converted in USD. But total amount are converted in EUR.
	=> From now, the buy and sell are only used for double checking in the Log.csv they don't impact the tuning.
	
- The neural files :
	- tmp/neuralres files : exports of the Perceptron loader commitee. contains start and end date of calculation in the name.
		-> dates are as follow : 
				startdate = calculation current date - 100 days (as a marign of pre calculated data)
				enddate = calculation current date + recalculation frequency (as we precalculate events for the test until the next recalculation)
		
	- autoPortfolio/tune..._configHistory.csv : contains the best configs as results of training by the OnTheFlyTuner. 
		-> date are as follow :
				startdate = start date of training ie  calculation current date - 2 years
				enddate = end date of training ie  calculation current date
- The different event sources : 
	- IndicatorCalculationThread (MSTAEvents, MSWeather): calculate for each stock in market independently of portofolios and potentially generate events per calculation
	- AlertCalculationThread (MSAlert,MSUserAlert) : specific calculation for each stock in portfolios and potentially generate events per calculation
	- Screener (MSScreening, MSUserScreening): calculate for each stock in market independently of portofolios and generate events by comparison side by side of each calculation result 
	- Portfolio (AutoBuySell,UserBuySell): buy and sell happening in portfolios.
- Buy :
 	- Growth Cie :     
 		- A strong balance sheet - A high return on capital (at least 10%) - High profit margins - Consistently above-average earnings growth.
 	- When P/E ratio will have fallen to roughly the same level as the market : "P/E Ratio Better than Industry Average"
 	- ** High forecast earnings growth and a relatively low prospective P/E. i.e. a low Price:Earnings Growth ratio (PEG).
 		Forward P/E : below 15, Forward EPS growth above 20%, Forward PEG : below 0.75
 	- Favour companies with a strong cash position.
 	- Avoid companies with a high debt-to-equity ratio ('gearing')
 	- quarterly earnings increases of 40-500%
 	- The less stock there is to buy, the more any buying will drive up the price. Look for companies with around 10-25 million shares in issue. 
 		Watch for a rise in the amount of shares traded ('volume') of at least 50% above average.
	- low GYP (Earnings Growth + Dividend Yield) : P/E ratio
	- Regular Growth
	- Perfs : (Peter Lynch) +20% de croissance, gearing de 1, PER inferieur a la croissance moyenne des benefices
	- For the most part, we should be looking for stocks that have a dividend payout ratio somewhere between 40-60%. 
- Sell :
	- 10% every time the price rose 10%. Smaller investors may need to think in terms of selling 25-33% on each 20% advance
 	- The prospective PEG reaches 1.2 or higher.
 	- Selling any stock that has dropped 7-8% below the price you paid.
 	- Consider selling stocks that have not risen 20% or more after 13 weeks. And consider holding those that have risen 20% in 4-5 weeks.
 	
- Tuning schedule :
	Daily autoPortfolios tuning :
	- tuning occures every 'tunefreq' month and is done over 'tunespan' months previous to today's date.
	- calculation occures between startdate and today's date.
	- retraining occures every month based on the last modification of the neural files found.
	Hence if 'tunfreq' == 1 : no retraing will ever occure. 
	
	OnTheFlyTuningTester :
	- tuning will be run every 'tunefreq' month periods between startdate and enddate and will be done over 'tunespan' months previous to each period start date.
	- calculation will be done for each period between start period date and end period date.
	- NO retraining will occure as neural files just being created will be less than a month old ie less then the past by dat limite. (or is training being forced?)
	
	GWT Share service : (must support autoPortfolio like tuning and on the fly tester style at the same time).
	- The on the fly doesn't use the tunedconf as per autoPortfolios tuning does. 
	- Tuning should be done once only => Events from previous tuning are kept and reloaded instead of recalculated. Start date is adjusted on the last event date reloaded.
	
- Repackaging :
	- pmIntra becomes : pmForecast + pmCore + pmUI. 
	- pmGWT stays in local git
	- pmUI : commit to sf git
	- pmForecastEngine + pmCore : create jars.
	- UI = pmUI + pmCore
	- AWS = pmGWT + pmCore + pmForecastEngine
	- MyUI = pmUI + pmCore + pmForecastEngine
 
 P/E is usually from the last four quarters (trailing P/E), 
 	but sometimes it can be taken from the estimates of earnings expected in the next four quarters (projected or forward P/E)
 P/E = share price / EPS 
 PEG = Price Earning / Earning Per Share growth
 PEG =(P/E) / annual EPS growth

 yahoo  EPS (is stated for the most recent 12 months):	http://uk.finance.yahoo.com/q?s=GOOG
 yahoo  Forward P/E:									http://finance.yahoo.com/q/ae?s=GOOG  : Avg. Estimate
 yahoo  Growth Est :									http://finance.yahoo.com/q/ae?s=GOOG
 boursorama  EPS (ie BNA) et PER et Dividendes: 		http://www.boursorama.com/cours.phtml?symbole=GOOG
 
- How to test UserPortfolioUpdate : Write a massive integration test?
	- Alerts : 
		- Reload gnucash portfolio
		- Check and fix buy dates backward
		- Run UserPortfolioUpdate <date in past> -updateAlerts
		- check emails.
	- Weather
		- Set the endDate in db.props on the first of a months with a weather event (ex 01 05 2012 as april was bullish)
		- Run UserPortfolioUpdate <date in past> -updateWeatherEvents -updateWeather
		- check emails.
	- Trend screening
		- Make sure that at least one monitored share is in "YAHOOINDICES,NDX:NASDAQ,NY:NYSE" or "YAHOOINDICES,FTSE:LSE,SBF250:EURONEXT"
		- Run UserPortfolioUpdate <date in past> -updateTrendScreening -updateOpinions
		- check emails.
	- Neural
		- run cleanStart.sh
		- endDate must be empty
		- change code to filter one or two appropriate stocks in the monitoredStocks loop of updateNeuralEvents method.
		- Run UserPortfolioUpdate <date in past> -updateNeuralEvents
		- check emails + checks tmp/*Dump*.csv and tmp/*Config*.csv
		- Re run to test the incremental update.
		
		
Markets :
ij> select * from portfolio_name;
NAME                                              |TYPE                            |TOTALINAMOUNTEVER    |TOTALOUTAMOUNTEVER   |BUYPONDERATIONRULE                                |SELLPONDERATIONRULE                               |POR&
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
YAHOOINDICES,GSPTSE:TSX                           |ShareList                       |0.00                 |0.00                 |NULL                                              |NULL                                              |NULL
YAHOOINDICES,DJI:NYSE                             |ShareList                       |0.00                 |0.00                 |NULL                                              |NULL                                              |NULL
YAHOOINDICES,FTLC:LSE,NDX:NASDAQ,NY:NYSE,SBF250:E&|ShareList                       |0.00                 |0.00                 |NULL                                              |NULL                                              |NULL
Sample Portfolio                                  |default                         |652.43               |0.00                 |NULL                                              |NULL                                              |NULL
YAHOOINDICES,AXJO:ASX                             |ShareList                       |0.00                 |0.00                 |NULL                                              |NULL                                              |NULL
YAHOOINDICES,GDAXI:EURONEXT                       |ShareList                       |0.00                 |0.00                 |NULL                                              |NULL                                              |NULL
YAHOOINDICES,SBF250:EURONEXT                      |ShareList                       |0.00                 |0.00                 |NULL                                              |NULL                                              |NULL
YAHOOINDICES,NDX:NASDAQ                           |ShareList                       |0.00                 |0.00                 |NULL                                              |NULL                                              |NULL
YAHOOINDICES,BSESN:BSE                            |ShareList                       |0.00                 |0.00                 |NULL                                              |NULL                                              |NULL
YAHOOINDICES,FTSE:LSE                             |ShareList                       |0.00                 |0.00                 |NULL                                              |NULL                                              |NULL

10 rows selected
ij> select count(*) from portfolio where portfolio.name='YAHOOINDICES,GSPTSE:TSX';
1          
-----------
0          

1 row selected
ij> select count(*) from portfolio where portfolio.name='YAHOOINDICES,DJI:NYSE';
1          
-----------
30         

1 row selected
ij> select count(*) from portfolio where portfolio.name='YAHOOINDICES,AXJO:ASX';
1          
-----------
166        

1 row selected
ij> select count(*) from portfolio where portfolio.name='YAHOOINDICES,GDAXI:EURONEXT';
1          
-----------
30         

1 row selected
ij> select count(*) from portfolio where portfolio.name='YAHOOINDICES,SBF250:EURONEXT';
1          
-----------
347        

1 row selected
ij> select count(*) from portfolio where portfolio.name='YAHOOINDICES,NDX:NASDAQ';
1          
-----------
91         

ij> select count(*) from portfolio where portfolio.name='YAHOOINDICES,BSESN:BSE';
1          
-----------
0          

1 row selected
ij> select count(*) from portfolio where portfolio.name='YAHOOINDICES,FTSE:LSE';
1          
-----------
118        
		
	
	


	
	






 
